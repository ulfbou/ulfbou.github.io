@using MudBlazor
@inherits LayoutComponentBase
@inject Homepage.Common.Services.AudienceContextService AudienceService
@inject NavigationManager NavManager
@inject Homepage.Common.Services.FilterService FilterService

<MudThemeProvider @bind-IsDarkMode="@_isDarkMode" Theme="CustomTheme"/>
<MudDialogProvider />
<MudSnackbarProvider />
<MudLayout>
    <MudAppBar Elevation="1" Class="mud-appbar-fixed-top">
        <MudIconButton Icon="@Icons.Material.Filled.Menu" Color="Color.Inherit" Edge="Edge.Start" OnClick="@((e) => ToggleNavMenu())" />
        <MudText Typo="Typo.h5" Class="ml-4 cursor-pointer" OnClick="NavigateHome">Ulf's Portfolio</MudText>
        <MudSpacer />

        <MudTextField T="string"
                      Placeholder="Search..."
                      Variant="Variant.Text"
                      Adornment="Adornment.End"
                      AdornmentIcon="@Icons.Material.Filled.Search"
                      AdornmentColor="Color.Inherit"
                      Class="mr-4 ml-auto"
                      Style="max-width: 300px; min-width: 150px;"
                      @bind-Value="FilterService.CurrentSearchText" /> 

        @if (AudienceService != null)
        {
            <MudChip T="string" Color="Color.Primary" Variant="Variant.Filled" Class="mr-4">
                Viewing as: @AudienceService.CurrentAudience
            </MudChip>
        }

        <MudIconButton Icon="@Icons.Material.Filled.LightMode" Color="Color.Inherit" OnClick="@ToggleDarkMode" Class="mr-2" />
        <MudIconButton Icon="@Icons.Custom.Brands.LinkedIn" Color="Color.Inherit" Href="https://www.linkedin.com/in/ulfbourelius/" Target="_blank" />
        <MudIconButton Icon="@Icons.Custom.Brands.GitHub" Color="Color.Inherit" Href="https://github.com/UlfBourelius" Target="_blank" />
    </MudAppBar>

    <MudDrawer @bind-Open="@_drawerOpen" Elevation="2" Fixed="true" Breakpoint="Breakpoint.Md" Width="280px">
        <MudDrawerHeader>
            <MudText Typo="Typo.h6">Navigation</MudText>
        </MudDrawerHeader>
        <NavMenu />
    </MudDrawer>

    <MudMainContent>
        <MudContainer MaxWidth="MaxWidth.Large" Class="mt-8 mb-8 px-4 py-8">
            @Body
        </MudContainer>
    </MudMainContent>
    
    <footer Class="py-4 mt-auto">
        <MudText Typo="Typo.body2" Class="text-center w-full">
            &copy; @DateTime.Now.Year Ulf Bourelius. Built with Blazor and MudBlazor.
            <MudLink Href="https://github.com/UlfBourelius/Portfolio-Website-Blazor" Target="_blank">Source Code</MudLink> | 
            <MudLink Href="https://www.linkedin.com/in/ulfbourelius/" Target="_blank">LinkedIn</MudLink>
        </MudText>
    </footer>
</MudLayout>
